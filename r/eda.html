<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Seunghun Lee">
<meta name="dcterms.date" content="2023-11-23">

<title>IPEDS EDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="eda_files/libs/quarto-html/quarto.js"></script>
<script src="eda_files/libs/quarto-html/popper.min.js"></script>
<script src="eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#preparations" id="toc-preparations" class="nav-link" data-scroll-target="#preparations"><span class="toc-section-number">2</span>  Preparations</a></li>
  <li><a href="#overview-structure-and-data-content" id="toc-overview-structure-and-data-content" class="nav-link" data-scroll-target="#overview-structure-and-data-content"><span class="toc-section-number">3</span>  Overview: Structure and Data Content</a>
  <ul class="collapse">
  <li><a href="#skimming-data" id="toc-skimming-data" class="nav-link" data-scroll-target="#skimming-data"><span class="toc-section-number">3.1</span>  Skimming data</a></li>
  <li><a href="#removing-redundant-variables" id="toc-removing-redundant-variables" class="nav-link" data-scroll-target="#removing-redundant-variables"><span class="toc-section-number">3.2</span>  Removing redundant variables</a></li>
  </ul></li>
  <li><a href="#missing-data-analysis" id="toc-missing-data-analysis" class="nav-link" data-scroll-target="#missing-data-analysis"><span class="toc-section-number">4</span>  Missing Data Analysis</a>
  <ul class="collapse">
  <li><a href="#listwise-deletion" id="toc-listwise-deletion" class="nav-link" data-scroll-target="#listwise-deletion"><span class="toc-section-number">4.1</span>  Listwise deletion</a></li>
  <li><a href="#multiple-imputation" id="toc-multiple-imputation" class="nav-link" data-scroll-target="#multiple-imputation"><span class="toc-section-number">4.2</span>  Multiple Imputation</a></li>
  <li><a href="#check" id="toc-check" class="nav-link" data-scroll-target="#check"><span class="toc-section-number">4.3</span>  Check</a></li>
  </ul></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="toc-section-number">5</span>  Visualization</a>
  <ul class="collapse">
  <li><a href="#predictor-features" id="toc-predictor-features" class="nav-link" data-scroll-target="#predictor-features"><span class="toc-section-number">5.1</span>  Predictor Features</a></li>
  <li><a href="#target-bachelor_within_4years" id="toc-target-bachelor_within_4years" class="nav-link" data-scroll-target="#target-bachelor_within_4years"><span class="toc-section-number">5.2</span>  Target: <code>bachelor_within_4years</code></a></li>
  <li><a href="#predictor-feature-interactions" id="toc-predictor-feature-interactions" class="nav-link" data-scroll-target="#predictor-feature-interactions"><span class="toc-section-number">5.3</span>  Predictor Feature Interactions</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations"><span class="toc-section-number">5.4</span>  Correlations</a></li>
  </ul></li>
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="toc-section-number">6</span>  Feature Selection</a>
  <ul class="collapse">
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis"><span class="toc-section-number">6.1</span>  Principal Component Analysis</a></li>
  <li><a href="#parallel-analysis" id="toc-parallel-analysis" class="nav-link" data-scroll-target="#parallel-analysis"><span class="toc-section-number">6.2</span>  Parallel Analysis</a></li>
  <li><a href="#contributions-of-variables-to-each-pcs" id="toc-contributions-of-variables-to-each-pcs" class="nav-link" data-scroll-target="#contributions-of-variables-to-each-pcs"><span class="toc-section-number">6.3</span>  Contributions of variables to each PCs</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">IPEDS EDA</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Seunghun Lee </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Clear environment</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The notebook is to execute exploratory data analysis for IPEDS data.</p>
<p>Data source: <a href="https://nces.ed.gov/ipeds/use-the-data">IPEDS</a></p>
<p>R code: <a href="https://github.com/slee0719/ipeds/tree/gh-pages">Github</a></p>
</section>
<section id="preparations" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Preparations</h1>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Load Libraries</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Helper Functions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Import data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Loading necessary libraries for data wrangling and visualization.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>libs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'openxlsx'</span>, <span class="st">"stringr"</span>,                        <span class="co"># read/write data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'skimr'</span>, <span class="st">"PerformanceAnalytics"</span>, <span class="st">"corrplot"</span>,  <span class="co"># exploring data</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"dplyr"</span>, <span class="st">"stringr"</span>, <span class="st">"glue"</span>,                   <span class="co"># data manipulation</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'gt'</span>, <span class="st">'ggplot2'</span>, <span class="st">"patchwork"</span>, <span class="st">"psych"</span>,        <span class="co"># data visualization</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"naniar"</span>, <span class="st">"mice"</span>,                             <span class="co"># missing data analysis</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"stats"</span>, <span class="st">"paran"</span>, <span class="st">"factoextra"</span>,               <span class="co"># feature selection</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"rsample"</span>, <span class="st">"glmnet"</span>)                          <span class="co"># predictive analysis</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(libs, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Create helper functions to facilitate an analysis</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># negation of %in%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">'%!in%'</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y)<span class="sc">!</span>(<span class="st">'%in%'</span>(x,y)) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prevent clashes with other packages</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity check custom function</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>sanity_check <span class="ot">&lt;-</span> <span class="cf">function</span>(data, type, vars) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  enquo_cols <span class="ot">&lt;-</span> <span class="fu">enquos</span>(vars)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">"missing"</span>){</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check missing values</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    n_missing <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>({{vars}})))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The number of missing value in"</span>, <span class="st">" "</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(vars)), <span class="st">" "</span>, <span class="st">"is"</span>, <span class="st">" "</span>, <span class="fu">toString</span>(n_missing)))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>({{vars}})) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">"duplication"</span>){</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check duplicated values</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    n_dup <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by_at</span>(enquo_cols) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>({{vars}}) <span class="sc">%&gt;%</span> <span class="fu">with</span>(<span class="fu">nrow</span>(.))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The unique number of duplicated value"</span>, <span class="st">" is "</span>, <span class="fu">toString</span>(n_dup)))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    dup_list <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by_at</span>(enquo_cols) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>({{vars}})</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dup_list, <span class="at">by =</span> <span class="fu">names</span>(<span class="fu">select</span>(., {{vars}}))) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"skim"</span>) {</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skim data</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    skimr<span class="sc">::</span><span class="fu">skim</span>(data) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Importing data for our analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ipeds <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"../data/IPEDS_data.xlsx"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="overview-structure-and-data-content" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Overview: Structure and Data Content</h1>
<p>The first thing I want to do is to look at the actual data in its raw form. It will show the types of features I am dealing with (numeric, categorical, string, etc.), as well as will reveal some characteristics of the dataset. This includes the process of missing data analysis.</p>
<section id="skimming-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="skimming-data"><span class="header-section-number">3.1</span> Skimming data</h2>
<p>I start by examining the data through the <code>skimr</code> tool. It allows us to see the data types involved and the shape of the data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(ipeds) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">ipeds</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1534</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">118</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>I find:</p>
<ul>
<li>The dataset contains 145 columns and 1534 rows, which is relatively small in terms of sample size. The number of variables is considerably large considering the sample size.</li>
<li>There is <code>ID.number</code> column with appears to be an unique identifier.</li>
<li>There are 27 string columns in the dataset. Those consist of basic information of the institution and the features (e.g.&nbsp;degree offered, religious affiliation).</li>
<li>There are 118 numeric columns in the dataset. Some of columns are suppposed to be converted to the categorical variable considering their forms (e.g.&nbsp;<code>ID.number</code>)</li>
<li>Missing values can be observed from the data. This is something I need to keep in mind in future exploratory and modelling steps.</li>
</ul>
</section>
<section id="removing-redundant-variables" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="removing-redundant-variables"><span class="header-section-number">3.2</span> Removing redundant variables</h2>
<p>Let’s select only “useful” information from the data</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Categorical variables</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Numeric variables</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ipeds <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Religious.affiliation, Level.of.institution, Control.of.institution, Historically.Black.College.or.University, Tribal.college) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Categorical Variables"</span> <span class="ot">=</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="lkugdtpwak" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lkugdtpwak table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lkugdtpwak thead, #lkugdtpwak tbody, #lkugdtpwak tfoot, #lkugdtpwak tr, #lkugdtpwak td, #lkugdtpwak th {
  border-style: none;
}

#lkugdtpwak p {
  margin: 0;
  padding: 0;
}

#lkugdtpwak .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lkugdtpwak .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lkugdtpwak .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lkugdtpwak .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lkugdtpwak .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkugdtpwak .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkugdtpwak .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lkugdtpwak .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lkugdtpwak .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lkugdtpwak .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lkugdtpwak .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lkugdtpwak .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lkugdtpwak .gt_spanner_row {
  border-bottom-style: hidden;
}

#lkugdtpwak .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lkugdtpwak .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lkugdtpwak .gt_from_md > :first-child {
  margin-top: 0;
}

#lkugdtpwak .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lkugdtpwak .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lkugdtpwak .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lkugdtpwak .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lkugdtpwak .gt_row_group_first td {
  border-top-width: 2px;
}

#lkugdtpwak .gt_row_group_first th {
  border-top-width: 2px;
}

#lkugdtpwak .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkugdtpwak .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lkugdtpwak .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lkugdtpwak .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkugdtpwak .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkugdtpwak .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lkugdtpwak .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lkugdtpwak .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lkugdtpwak .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lkugdtpwak .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkugdtpwak .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkugdtpwak .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lkugdtpwak .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lkugdtpwak .gt_left {
  text-align: left;
}

#lkugdtpwak .gt_center {
  text-align: center;
}

#lkugdtpwak .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lkugdtpwak .gt_font_normal {
  font-weight: normal;
}

#lkugdtpwak .gt_font_bold {
  font-weight: bold;
}

#lkugdtpwak .gt_font_italic {
  font-style: italic;
}

#lkugdtpwak .gt_super {
  font-size: 65%;
}

#lkugdtpwak .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lkugdtpwak .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lkugdtpwak .gt_indent_1 {
  text-indent: 5px;
}

#lkugdtpwak .gt_indent_2 {
  text-indent: 10px;
}

#lkugdtpwak .gt_indent_3 {
  text-indent: 15px;
}

#lkugdtpwak .gt_indent_4 {
  text-indent: 20px;
}

#lkugdtpwak .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Categorical Variables">Categorical Variables</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Categorical Variables" class="gt_row gt_left">Religious.affiliation</td></tr>
    <tr><td headers="Categorical Variables" class="gt_row gt_left">Level.of.institution</td></tr>
    <tr><td headers="Categorical Variables" class="gt_row gt_left">Control.of.institution</td></tr>
    <tr><td headers="Categorical Variables" class="gt_row gt_left">Historically.Black.College.or.University</td></tr>
    <tr><td headers="Categorical Variables" class="gt_row gt_left">Tribal.college</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Categorical variables selection:</p>
<ul>
<li><code>Religious.affiliation</code>: to which religion is the school affiliated (e.g.&nbsp;Churches of Christ)</li>
<li><code>Level.of.institution</code>: the level of degree being offered (e.g.&nbsp;Four or more years)</li>
<li><code>Copntrol.of.institution</code>: indicates whether it is private or public school</li>
<li><code>Historically.Black.College.or.University</code>: indicates whether it is historically black institution</li>
<li><code>Tribal.college</code>: indicates whether the college is affiliated with a tribe</li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID.number, Enrolled.total, ACT.Composite<span class="fl">.75</span>th.percentile.score, <span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>), <span class="st">`</span><span class="at">Number.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>, <span class="st">`</span><span class="at">Graduation.rate.-.Bachelor.degree.within.4.years,.total</span><span class="st">`</span>, Percent.of.freshmen.receiving.Pell.grants) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Numeric Variables"</span> <span class="ot">=</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="krevbqpjvj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#krevbqpjvj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#krevbqpjvj thead, #krevbqpjvj tbody, #krevbqpjvj tfoot, #krevbqpjvj tr, #krevbqpjvj td, #krevbqpjvj th {
  border-style: none;
}

#krevbqpjvj p {
  margin: 0;
  padding: 0;
}

#krevbqpjvj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#krevbqpjvj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#krevbqpjvj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#krevbqpjvj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#krevbqpjvj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#krevbqpjvj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#krevbqpjvj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#krevbqpjvj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#krevbqpjvj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#krevbqpjvj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#krevbqpjvj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#krevbqpjvj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#krevbqpjvj .gt_spanner_row {
  border-bottom-style: hidden;
}

#krevbqpjvj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#krevbqpjvj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#krevbqpjvj .gt_from_md > :first-child {
  margin-top: 0;
}

#krevbqpjvj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#krevbqpjvj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#krevbqpjvj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#krevbqpjvj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#krevbqpjvj .gt_row_group_first td {
  border-top-width: 2px;
}

#krevbqpjvj .gt_row_group_first th {
  border-top-width: 2px;
}

#krevbqpjvj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#krevbqpjvj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#krevbqpjvj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#krevbqpjvj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#krevbqpjvj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#krevbqpjvj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#krevbqpjvj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#krevbqpjvj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#krevbqpjvj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#krevbqpjvj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#krevbqpjvj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#krevbqpjvj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#krevbqpjvj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#krevbqpjvj .gt_left {
  text-align: left;
}

#krevbqpjvj .gt_center {
  text-align: center;
}

#krevbqpjvj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#krevbqpjvj .gt_font_normal {
  font-weight: normal;
}

#krevbqpjvj .gt_font_bold {
  font-weight: bold;
}

#krevbqpjvj .gt_font_italic {
  font-style: italic;
}

#krevbqpjvj .gt_super {
  font-size: 65%;
}

#krevbqpjvj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#krevbqpjvj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#krevbqpjvj .gt_indent_1 {
  text-indent: 5px;
}

#krevbqpjvj .gt_indent_2 {
  text-indent: 10px;
}

#krevbqpjvj .gt_indent_3 {
  text-indent: 15px;
}

#krevbqpjvj .gt_indent_4 {
  text-indent: 20px;
}

#krevbqpjvj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Numeric Variables">Numeric Variables</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Numeric Variables" class="gt_row gt_left">ID.number</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Enrolled.total</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">ACT.Composite.75th.percentile.score</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.American.Indian.or.Alaska.Native</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Asian</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Black.or.African.American</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Hispanic/Latino</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Native.Hawaiian.or.Other.Pacific.Islander</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.White</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.two.or.more.races</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Race/ethnicity.unknown</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Nonresident.Alien</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.Asian/Native.Hawaiian/Pacific.Islander</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.undergraduate.enrollment.that.are.women</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Number.of.first-time.undergraduates.-.in-state</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Graduation.rate.-.Bachelor.degree.within.4.years,.total</td></tr>
    <tr><td headers="Numeric Variables" class="gt_row gt_left">Percent.of.freshmen.receiving.Pell.grants</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Numeric variables selection:</p>
<ul>
<li><code>ID.number</code>: the school unique identifier</li>
<li><code>Enrolled.total</code>: the number of student who were actually enrolled</li>
<li><code>ACT.Composite.75th.percentile.score</code>: 75th percentile composite ACT score</li>
<li><code>Percent.of.undergraduate.enrollment.that.are</code>: variables indicate the percentage of ethnicity of undergraduate who enrolled</li>
<li><code>Number.of.first-time.undergraduates.-.in-state</code>: indicates the number of in-state undergraduates who are included in the group of “first-time college entrants”</li>
<li><code>Graduation.rate.-.Bachelor.degree.within.4.years,.total</code>: the percentage of undergraduates graduating within 4 years</li>
<li><code>Percent.of.freshmen.receiving.Pell.grants</code>: the percentage of freshmen who received the <a href="https://studentaid.gov/understand-aid/types/grants/pell">Federal Pell Grant</a></li>
</ul>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change the nambes of variables </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ipeds_sub <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id =</span> ID.number,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">bach =</span> <span class="st">`</span><span class="at">Offers.Bachelor's.degree</span><span class="st">`</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrolled_total =</span> Enrolled.total, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">act_75th_percentile =</span> ACT.Composite<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>), </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ftic_perc =</span> <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">bachelor_within_4years =</span> <span class="st">`</span><span class="at">Graduation.rate.-.Bachelor.degree.within.4.years,.total</span><span class="st">`</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pell_grant_perc =</span> Percent.of.freshmen.receiving.Pell.grants, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">religion =</span> Religious.affiliation, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">edu_level =</span> Level.of.institution, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">sch_type =</span> Control.of.institution, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">black_inst =</span> Historically.Black.College.or.University, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">tribal_inst =</span> Tribal.college) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"perc_ai_an"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.American.Indian.or.Alaska.Native,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_as"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Asian,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_bl"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Black.or.African.American,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_hi"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Hispanic/Latino</span><span class="st">`</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_nh_pi"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Native.Hawaiian.or.Other.Pacific.Islander,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_wh"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.White,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_mix"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.two.or.more.races,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_un"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Race/ethnicity.unknown</span><span class="st">`</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_in"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Nonresident.Alien,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_f"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.women</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sch_type =</span> <span class="fu">ifelse</span>(sch_type <span class="sc">==</span> <span class="st">"Public"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Asian/Native.Hawaiian/Pacific.Islander</span><span class="st">`</span>) </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Feature transformation</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>ipeds_sub <span class="ot">&lt;-</span> ipeds_sub <span class="sc">%&gt;%</span> </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(is.character, as.factor)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="missing-data-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Missing Data Analysis</h1>
<p>Let’s have a closer look at those missing values. How many are there in total in the dataset?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(ipeds_sub <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(enrolled_total), enrolled_total <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(bach <span class="sc">==</span> <span class="st">"Yes"</span>)) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="ktuwtvlxjr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ktuwtvlxjr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ktuwtvlxjr thead, #ktuwtvlxjr tbody, #ktuwtvlxjr tfoot, #ktuwtvlxjr tr, #ktuwtvlxjr td, #ktuwtvlxjr th {
  border-style: none;
}

#ktuwtvlxjr p {
  margin: 0;
  padding: 0;
}

#ktuwtvlxjr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ktuwtvlxjr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ktuwtvlxjr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ktuwtvlxjr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ktuwtvlxjr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ktuwtvlxjr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ktuwtvlxjr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ktuwtvlxjr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ktuwtvlxjr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ktuwtvlxjr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ktuwtvlxjr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ktuwtvlxjr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ktuwtvlxjr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ktuwtvlxjr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ktuwtvlxjr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ktuwtvlxjr .gt_from_md > :first-child {
  margin-top: 0;
}

#ktuwtvlxjr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ktuwtvlxjr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ktuwtvlxjr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ktuwtvlxjr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ktuwtvlxjr .gt_row_group_first td {
  border-top-width: 2px;
}

#ktuwtvlxjr .gt_row_group_first th {
  border-top-width: 2px;
}

#ktuwtvlxjr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktuwtvlxjr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ktuwtvlxjr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ktuwtvlxjr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ktuwtvlxjr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktuwtvlxjr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ktuwtvlxjr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ktuwtvlxjr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ktuwtvlxjr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ktuwtvlxjr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ktuwtvlxjr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktuwtvlxjr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ktuwtvlxjr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktuwtvlxjr .gt_left {
  text-align: left;
}

#ktuwtvlxjr .gt_center {
  text-align: center;
}

#ktuwtvlxjr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ktuwtvlxjr .gt_font_normal {
  font-weight: normal;
}

#ktuwtvlxjr .gt_font_bold {
  font-weight: bold;
}

#ktuwtvlxjr .gt_font_italic {
  font-style: italic;
}

#ktuwtvlxjr .gt_super {
  font-size: 65%;
}

#ktuwtvlxjr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ktuwtvlxjr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ktuwtvlxjr .gt_indent_1 {
  text-indent: 5px;
}

#ktuwtvlxjr .gt_indent_2 {
  text-indent: 10px;
}

#ktuwtvlxjr .gt_indent_3 {
  text-indent: 15px;
}

#ktuwtvlxjr .gt_indent_4 {
  text-indent: 20px;
}

#ktuwtvlxjr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variable">variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_miss">n_miss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pct_miss">pct_miss</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variable" class="gt_row gt_left">ftic_perc</td>
<td headers="n_miss" class="gt_row gt_right">517</td>
<td headers="pct_miss" class="gt_row gt_right">37.5726744</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">act_75th_percentile</td>
<td headers="n_miss" class="gt_row gt_right">177</td>
<td headers="pct_miss" class="gt_row gt_right">12.8633721</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">bachelor_within_4years</td>
<td headers="n_miss" class="gt_row gt_right">9</td>
<td headers="pct_miss" class="gt_row gt_right">0.6540698</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">pell_grant_perc</td>
<td headers="n_miss" class="gt_row gt_right">3</td>
<td headers="pct_miss" class="gt_row gt_right">0.2180233</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">id</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">bach</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">enrolled_total</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_ai_an</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_as</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_bl</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_hi</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_nh_pi</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_wh</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_mix</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_un</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_in</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_f</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">religion</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">edu_level</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">sch_type</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">black_inst</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">tribal_inst</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0.0000000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>There are various missing values in most of the columns. In this case, it is good to categorize them into the <a href="https://en.wikipedia.org/wiki/Missing_data">types of missing data</a>.</p>
<p>I find:</p>
<ul>
<li><code>pell_grant_perc</code>: MCAR, hard to figure out the rationale of the missing data due to its small number (3 NAs) – will be removed from the dataset</li>
<li><code>bachelor_within_4years</code>: MCAR, as other related columns (<code>Bachelor_within_5years</code> and <code>Bachelor_within_6years</code>) are also empty, it appears that these entries were not reported – will be removed from the dataset</li>
<li><code>act_75th_percentile</code>: MAR, some applicants chose to take either the SAT or ACT for their college admission requirements. Assuming that the SAT score is positively correlated with the ACT score, multiple imputation will be conducted to fill in the blank.</li>
<li><code>ftic_perc</code>: the <code>ftic_perc</code> column contains a significant number of missing values, accounting for 37.6% of the data. To address this issue, we should investigate potential methods for imputing these missing values. While we currently lack information regarding any potential issues during the data collection process, it might be beneficial to explore insights from the dataset, such as information available in other columns, in order to assist with imputation. Following columns are potential variables which might be related to the <code>ftic_perc</code> - <strong>any ethnic properties</strong>, <strong>school type</strong>, <strong>pell_grant_perc</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Enrolled.total)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Offers.Bachelor's.degree</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percent.of.freshmen.receiving.Pell.grants)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         Control.of.institution,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         Historically.Black.College.or.University,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         Tribal.college,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         Percent.of.freshmen.receiving.Pell.grants,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Control.of.institution =</span> <span class="fu">ifelse</span>(Control.of.institution <span class="sc">==</span> <span class="st">"Public"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Historically.Black.College.or.University =</span> <span class="fu">ifelse</span>(Historically.Black.College.or.University <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Tribal.college =</span> <span class="fu">ifelse</span>(Tribal.college <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"perc_ai_an"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.American.Indian.or.Alaska.Native,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_as"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Asian,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_bl"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Black.or.African.American,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_hi"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Hispanic/Latino</span><span class="st">`</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_nh_pi"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Native.Hawaiian.or.Other.Pacific.Islander,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_wh"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.White,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_mix"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.two.or.more.races,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_un"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Race/ethnicity.unknown</span><span class="st">`</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_in"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Nonresident.Alien,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_f"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.women,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>       <span class="st">"bl_colllege"</span> <span class="ot">=</span> Historically.Black.College.or.University,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>       <span class="st">"tribal_college"</span> <span class="ot">=</span> Tribal.college,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>       <span class="st">"sch_type"</span> <span class="ot">=</span> Control.of.institution,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>       <span class="st">"pell"</span> <span class="ot">=</span> Percent.of.freshmen.receiving.Pell.grants,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>       <span class="st">"ftic"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Asian/Native.Hawaiian/Pacific.Islander</span><span class="st">`</span>) </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(foo, <span class="at">histogram=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As indicated in the correlation chart above, the top three variables associated with <code>ftic</code> are <code>school_type</code> (public or private), <code>pell_grant_perc</code>, and <code>perc_in</code> (non-resident alien). This findings align with my expectation for several reasons. First, non-resident aliens, who are international students, typically attend college in their home countries before attending college in the US. Second, students who can afford the tuition at multiple colleges are generally ineligible for the Pell Grant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>foo <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sch_type) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(ftic),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">median</span>(ftic)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="yinyrelnjg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yinyrelnjg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yinyrelnjg thead, #yinyrelnjg tbody, #yinyrelnjg tfoot, #yinyrelnjg tr, #yinyrelnjg td, #yinyrelnjg th {
  border-style: none;
}

#yinyrelnjg p {
  margin: 0;
  padding: 0;
}

#yinyrelnjg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yinyrelnjg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yinyrelnjg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yinyrelnjg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yinyrelnjg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yinyrelnjg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yinyrelnjg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yinyrelnjg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yinyrelnjg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yinyrelnjg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yinyrelnjg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yinyrelnjg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yinyrelnjg .gt_spanner_row {
  border-bottom-style: hidden;
}

#yinyrelnjg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yinyrelnjg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yinyrelnjg .gt_from_md > :first-child {
  margin-top: 0;
}

#yinyrelnjg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yinyrelnjg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yinyrelnjg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yinyrelnjg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yinyrelnjg .gt_row_group_first td {
  border-top-width: 2px;
}

#yinyrelnjg .gt_row_group_first th {
  border-top-width: 2px;
}

#yinyrelnjg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yinyrelnjg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yinyrelnjg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yinyrelnjg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yinyrelnjg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yinyrelnjg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yinyrelnjg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yinyrelnjg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yinyrelnjg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yinyrelnjg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yinyrelnjg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yinyrelnjg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yinyrelnjg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yinyrelnjg .gt_left {
  text-align: left;
}

#yinyrelnjg .gt_center {
  text-align: center;
}

#yinyrelnjg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yinyrelnjg .gt_font_normal {
  font-weight: normal;
}

#yinyrelnjg .gt_font_bold {
  font-weight: bold;
}

#yinyrelnjg .gt_font_italic {
  font-style: italic;
}

#yinyrelnjg .gt_super {
  font-size: 65%;
}

#yinyrelnjg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yinyrelnjg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yinyrelnjg .gt_indent_1 {
  text-indent: 5px;
}

#yinyrelnjg .gt_indent_2 {
  text-indent: 10px;
}

#yinyrelnjg .gt_indent_3 {
  text-indent: 15px;
}

#yinyrelnjg .gt_indent_4 {
  text-indent: 20px;
}

#yinyrelnjg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sch_type">sch_type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean.ftic.">mean.ftic.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median.ftic.">median.ftic.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sch_type" class="gt_row gt_right">0</td>
<td headers="mean.ftic." class="gt_row gt_right">56.04018</td>
<td headers="median.ftic." class="gt_row gt_right">59.5</td></tr>
    <tr><td headers="sch_type" class="gt_row gt_right">1</td>
<td headers="mean.ftic." class="gt_row gt_right">81.93154</td>
<td headers="median.ftic." class="gt_row gt_right">87.0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>The most interesting variables is ‘school_type.’ In this analysis, I have defined “1” as public and “0” as private school. Notably, the proportion of ftic students is significantly higher in public schools. Here, we may hypothesize that students who already possess a bachelor’s degree tend to opt for private colleges, which are perceived to offer higher educational quality. <strong>Please note that this assumption is for the purpose of explaining the result and may be open to debate</strong>.</p>
<p>Based on the finding and the assumption, I define the missing values in ftic column as MAR and will conduct the multiple imputation using <code>school_type</code>, <code>pell_grant_perc</code>, and <code>perc_in</code>.</p>
<section id="listwise-deletion" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="listwise-deletion"><span class="header-section-number">4.1</span> Listwise deletion</h2>
<p>Simply remove the cases with NAs in such columns - <code>pell_grant_pec</code>, <code>bachelor_within_4years</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld <span class="ot">&lt;-</span> ipeds_sub <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(enrolled_total <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(enrolled_total)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bach <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pell_grant_perc)) <span class="sc">%&gt;%</span> <span class="co"># remove NA cases from pell_grant_perc</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bachelor_within_4years)) <span class="co"># remove NA cases from bachelor_within_4years</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld <span class="sc">%&gt;%</span> <span class="fu">select</span>(pell_grant_perc, bachelor_within_4years) <span class="sc">%&gt;%</span> <span class="fu">miss_var_summary</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="dbrpncvsfh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dbrpncvsfh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dbrpncvsfh thead, #dbrpncvsfh tbody, #dbrpncvsfh tfoot, #dbrpncvsfh tr, #dbrpncvsfh td, #dbrpncvsfh th {
  border-style: none;
}

#dbrpncvsfh p {
  margin: 0;
  padding: 0;
}

#dbrpncvsfh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dbrpncvsfh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dbrpncvsfh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dbrpncvsfh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dbrpncvsfh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbrpncvsfh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbrpncvsfh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbrpncvsfh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dbrpncvsfh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dbrpncvsfh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dbrpncvsfh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dbrpncvsfh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dbrpncvsfh .gt_spanner_row {
  border-bottom-style: hidden;
}

#dbrpncvsfh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dbrpncvsfh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dbrpncvsfh .gt_from_md > :first-child {
  margin-top: 0;
}

#dbrpncvsfh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dbrpncvsfh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dbrpncvsfh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dbrpncvsfh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dbrpncvsfh .gt_row_group_first td {
  border-top-width: 2px;
}

#dbrpncvsfh .gt_row_group_first th {
  border-top-width: 2px;
}

#dbrpncvsfh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbrpncvsfh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dbrpncvsfh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dbrpncvsfh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbrpncvsfh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbrpncvsfh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dbrpncvsfh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dbrpncvsfh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dbrpncvsfh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbrpncvsfh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbrpncvsfh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbrpncvsfh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbrpncvsfh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbrpncvsfh .gt_left {
  text-align: left;
}

#dbrpncvsfh .gt_center {
  text-align: center;
}

#dbrpncvsfh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dbrpncvsfh .gt_font_normal {
  font-weight: normal;
}

#dbrpncvsfh .gt_font_bold {
  font-weight: bold;
}

#dbrpncvsfh .gt_font_italic {
  font-style: italic;
}

#dbrpncvsfh .gt_super {
  font-size: 65%;
}

#dbrpncvsfh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dbrpncvsfh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dbrpncvsfh .gt_indent_1 {
  text-indent: 5px;
}

#dbrpncvsfh .gt_indent_2 {
  text-indent: 10px;
}

#dbrpncvsfh .gt_indent_3 {
  text-indent: 15px;
}

#dbrpncvsfh .gt_indent_4 {
  text-indent: 20px;
}

#dbrpncvsfh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variable">variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_miss">n_miss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pct_miss">pct_miss</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variable" class="gt_row gt_left">pell_grant_perc</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">bachelor_within_4years</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="multiple-imputation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="multiple-imputation"><span class="header-section-number">4.2</span> Multiple Imputation</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">ACT</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">FTIC</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Let’s create <code>sat_comp</code> variable to combine all the SAT scores and conduct an univariate imputation with the combined sat score.</p>
<p>Imputation information is below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ipeds_sat <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID.number, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                 SAT.Critical.Reading<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 SAT.Math<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                 SAT.Writing<span class="fl">.75</span>th.percentile.score) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> ID.number, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_read =</span> SAT.Critical.Reading<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_math =</span> SAT.Math<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_writing =</span> SAT.Writing<span class="fl">.75</span>th.percentile.score) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sat_comp =</span> <span class="fu">rowMeans</span>(<span class="fu">subset</span>(., <span class="at">select =</span> <span class="fu">c</span>(sat_read, sat_math, sat_writing)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat <span class="ot">&lt;-</span> ipeds_sub_ld <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ipeds_sat, <span class="at">by =</span> <span class="st">"id"</span>) </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned <span class="ot">&lt;-</span> ipeds_sub_ld_sat <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">drop =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(sat_comp), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(drop <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(ipeds_sub_ld_sat_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(act_75th_percentile, sat_comp), </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">m =</span> <span class="dv">10</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">defaultMethod =</span> <span class="st">"pmm"</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  10 
Imputation methods:
act_75th_percentile            sat_comp 
              "pmm"                  "" 
PredictorMatrix:
                    act_75th_percentile sat_comp
act_75th_percentile                   0        1
sat_comp                              1        0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(act_75th_percentile, sat_comp)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">complete</span>(imp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Conduct multiple imputation with <code>pecc_in</code>, <code>pell_grant_perc</code>, and <code>sch_type</code>.</p>
<p>Imputation information is below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act <span class="sc">%&gt;%</span> <span class="fu">select</span>(perc_in, pell_grant_perc, sch_type, ftic_perc)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(foo, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">m =</span> <span class="dv">10</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">defaultMethod =</span> <span class="st">"pmm"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  10 
Imputation methods:
        perc_in pell_grant_perc        sch_type       ftic_perc 
             ""              ""              ""           "pmm" 
PredictorMatrix:
                perc_in pell_grant_perc sch_type ftic_perc
perc_in               0               1        1         1
pell_grant_perc       1               0        1         1
sch_type              1               1        0         1
ftic_perc             1               1        1         0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act_ftic <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ftic_perc)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">complete</span>(imp) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ftic_perc)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="check" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="check"><span class="header-section-number">4.3</span> Check</h2>
<p>Let’s clean the data and check the missing values again.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act_ftic2 <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act_ftic <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(bach, drop, religion, edu_level, tribal_inst,sat_read, sat_math, sat_writing)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sch_type_desc =</span> <span class="fu">ifelse</span>(sch_type <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"public"</span>, <span class="st">"private"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">black_inst_d =</span> <span class="fu">ifelse</span>(black_inst <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(ipeds_sub_ld_sat_cleaned_act_ftic2) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="cnzofyrqma" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cnzofyrqma table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cnzofyrqma thead, #cnzofyrqma tbody, #cnzofyrqma tfoot, #cnzofyrqma tr, #cnzofyrqma td, #cnzofyrqma th {
  border-style: none;
}

#cnzofyrqma p {
  margin: 0;
  padding: 0;
}

#cnzofyrqma .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cnzofyrqma .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cnzofyrqma .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cnzofyrqma .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cnzofyrqma .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cnzofyrqma .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnzofyrqma .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cnzofyrqma .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cnzofyrqma .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cnzofyrqma .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cnzofyrqma .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cnzofyrqma .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cnzofyrqma .gt_spanner_row {
  border-bottom-style: hidden;
}

#cnzofyrqma .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cnzofyrqma .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cnzofyrqma .gt_from_md > :first-child {
  margin-top: 0;
}

#cnzofyrqma .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cnzofyrqma .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cnzofyrqma .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cnzofyrqma .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cnzofyrqma .gt_row_group_first td {
  border-top-width: 2px;
}

#cnzofyrqma .gt_row_group_first th {
  border-top-width: 2px;
}

#cnzofyrqma .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnzofyrqma .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cnzofyrqma .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cnzofyrqma .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnzofyrqma .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnzofyrqma .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cnzofyrqma .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cnzofyrqma .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cnzofyrqma .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnzofyrqma .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cnzofyrqma .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnzofyrqma .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cnzofyrqma .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnzofyrqma .gt_left {
  text-align: left;
}

#cnzofyrqma .gt_center {
  text-align: center;
}

#cnzofyrqma .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cnzofyrqma .gt_font_normal {
  font-weight: normal;
}

#cnzofyrqma .gt_font_bold {
  font-weight: bold;
}

#cnzofyrqma .gt_font_italic {
  font-style: italic;
}

#cnzofyrqma .gt_super {
  font-size: 65%;
}

#cnzofyrqma .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cnzofyrqma .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cnzofyrqma .gt_indent_1 {
  text-indent: 5px;
}

#cnzofyrqma .gt_indent_2 {
  text-indent: 10px;
}

#cnzofyrqma .gt_indent_3 {
  text-indent: 15px;
}

#cnzofyrqma .gt_indent_4 {
  text-indent: 20px;
}

#cnzofyrqma .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variable">variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_miss">n_miss</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pct_miss">pct_miss</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variable" class="gt_row gt_left">id</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">enrolled_total</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_ai_an</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_as</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_bl</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_hi</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_nh_pi</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_wh</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_mix</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_un</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_in</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">perc_f</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">bachelor_within_4years</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">pell_grant_perc</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">sch_type</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">black_inst</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">act_75th_percentile</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">sat_comp</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">ftic_perc</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">sch_type_desc</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">black_inst_d</td>
<td headers="n_miss" class="gt_row gt_right">0</td>
<td headers="pct_miss" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act_ftic2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>No more missing value. Good!</p>
</section>
</section>
<section id="visualization" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Visualization</h1>
<p>Let’s take a look at the distribution of variables</p>
<section id="predictor-features" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="predictor-features"><span class="header-section-number">5.1</span> Predictor Features</h2>
<p>To assemble the plots in the comprehensive, dashboard-like overview we are using the <a href="https://patchwork.data-imaginist.com/index.html">patchwork package</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pell_grant_perc)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Pell Grant Percentage"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sch_type_desc) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sch_type_desc, n, <span class="at">fill =</span> sch_type_desc)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"School Type"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(black_inst, n, <span class="at">fill =</span> black_inst)) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Black Institution"</span>) </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(act_75th_percentile)) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"ACT 75th Percentile"</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ftic_perc)) <span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"violet"</span>) <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"FTIC Percentage"</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="st">ABC</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="st">DEE</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Variable Distributions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1248"></p>
</div>
</div>
<p>I find:</p>
<ul>
<li>The distribution of <code>pell_grant_percentage</code> and <code>act_7hth</code> are nearly normally distributed (slightly right skewed).</li>
<li><code>school_type</code> and <code>black_institution</code> are boolean features.</li>
<li><code>ftic_perc</code> is severely left skewed. May need a transformation if we want to add it in our model.</li>
</ul>
</section>
<section id="target-bachelor_within_4years" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="target-bachelor_within_4years"><span class="header-section-number">5.2</span> Target: <code>bachelor_within_4years</code></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Target: Bachelor within 4 Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We find:</p>
<ul>
<li>There is a slight imbalance in the target distribution. Slightly right skewed.</li>
</ul>
</section>
<section id="predictor-feature-interactions" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="predictor-feature-interactions"><span class="header-section-number">5.3</span> Predictor Feature Interactions</h2>
<p>How do the predictor features interact with each other?</p>
</section>
<section id="correlations" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="correlations"><span class="header-section-number">5.4</span> Correlations</h2>
<p>When plotting a correlation matrix, we need to make sure that what we’re feeding in doesn’t include any missing values. We can specify this via the parameter <code>use = "complete.obs"</code>:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, enrolled_total, sat_comp, sch_type_desc)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">black_inst_d =</span> <span class="fu">ifelse</span>(black_inst <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(bachelor_within_4years, <span class="at">.after =</span> ftic_perc) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chart.Correlation</span>(<span class="at">histogram=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We find:</p>
<ul>
<li>Multicollinearity is detected among several variables. Feature reduction process is necessary.</li>
</ul>
<section id="categorical-feature-interactions" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="categorical-feature-interactions"><span class="header-section-number">5.4.1</span> Categorical feature interactions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bachelor_within_4years, sch_type_desc) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years, <span class="at">group =</span> sch_type_desc, <span class="at">fill =</span> sch_type_desc)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We find:</p>
<ul>
<li>The number of students who got their bachelor in 4 years are larger in private schools than in public school</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bachelor_within_4years, black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years, <span class="at">group =</span> black_inst, <span class="at">fill =</span> black_inst)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We find:</p>
<ul>
<li>The number of students who got their bachelor in 4 years are larger in non-black institution than in black institution</li>
</ul>
</section>
</section>
</section>
<section id="feature-selection" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Feature Selection</h1>
<p>Conducting Principal Component Analysis using the Horn’s Parallel Analysis.</p>
<section id="principal-component-analysis" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="principal-component-analysis"><span class="header-section-number">6.1</span> Principal Component Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ipeds_imp_sub <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, enrolled_total, black_inst, sat_comp, sch_type_desc))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>pca_model <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(ipeds_imp_sub, <span class="at">scale=</span><span class="cn">TRUE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Explained Variances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Exploring Eigenvalues</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Visualization</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4     PC5     PC6     PC7
Standard deviation     2.0489 1.5132 1.3697 1.16298 1.09991 1.01318 0.94388
Proportion of Variance 0.2624 0.1431 0.1172 0.08453 0.07561 0.06416 0.05568
Cumulative Proportion  0.2624 0.4055 0.5227 0.60727 0.68288 0.74704 0.80272
                           PC8     PC9    PC10    PC11    PC12    PC13    PC14
Standard deviation     0.86375 0.81949 0.68189 0.63394 0.59236 0.43851 0.43168
Proportion of Variance 0.04663 0.04197 0.02906 0.02512 0.02193 0.01202 0.01165
Cumulative Proportion  0.84935 0.89132 0.92039 0.94550 0.96743 0.97945 0.99110
                          PC15    PC16
Standard deviation     0.37658 0.02486
Proportion of Variance 0.00886 0.00004
Cumulative Proportion  0.99996 1.00000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_eigenvalue</span>(pca_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         eigenvalue variance.percent cumulative.variance.percent
Dim.1  4.1979907993     26.237442496                    26.23744
Dim.2  2.2897449641     14.310906026                    40.54835
Dim.3  1.8760568678     11.725355424                    52.27370
Dim.4  1.3525167074      8.453229421                    60.72693
Dim.5  1.2098126438      7.561329024                    68.28826
Dim.6  1.0265261469      6.415788418                    74.70405
Dim.7  0.8909170990      5.568231868                    80.27228
Dim.8  0.7460600817      4.662875511                    84.93516
Dim.9  0.6715659355      4.197287097                    89.13245
Dim.10 0.4649695061      2.906059413                    92.03850
Dim.11 0.4018807055      2.511754410                    94.55026
Dim.12 0.3508943905      2.193089941                    96.74335
Dim.13 0.1922869326      1.201793329                    97.94514
Dim.14 0.1863502288      1.164688930                    99.10983
Dim.15 0.1418089946      0.886306216                    99.99614
Dim.16 0.0006179964      0.003862477                   100.00000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_model, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">choice =</span> <span class="fu">c</span>(<span class="st">"eigenvalue"</span>),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.var=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Based on the proportion of explained variance and the scree plot using eigenvalue, 4 components seem appropriate. However, recognizing the interpretation is subjective, an additional analysis is necessary to validate its plausibility.</p>
</section>
<section id="parallel-analysis" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="parallel-analysis"><span class="header-section-number">6.2</span> Parallel Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paran</span>(ipeds_imp_sub, <span class="at">graph =</span> <span class="cn">TRUE</span>, <span class="at">cfa =</span> <span class="cn">FALSE</span>, <span class="at">centile =</span> <span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Using eigendecomposition of correlation matrix.
Computing: 10%  20%  30%  40%  50%  60%  70%  80%  90%  100%


Results of Horn's Parallel Analysis for component retention
480 iterations, using the 95 centile estimate

-------------------------------------------------- 
Component   Adjusted    Unadjusted    Estimated 
            Eigenvalue  Eigenvalue    Bias 
-------------------------------------------------- 
1           3.956765    4.197990      0.241224
2           2.101792    2.289744      0.187952
3           1.722453    1.876056      0.153603
4           1.229423    1.352516      0.123093
5           1.114384    1.209812      0.095428
-------------------------------------------------- 

Adjusted eigenvalues &gt; 1 indicate dimensions to retain.
(5 components retained)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>According to Horn’s Parallel Analysis, 5 components can be selected.</p>
</section>
<section id="contributions-of-variables-to-each-pcs" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="contributions-of-variables-to-each-pcs"><span class="header-section-number">6.3</span> Contributions of variables to each PCs</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC1</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pc1 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC2</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>pc2 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">2</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC3</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>pc3 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">3</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC4</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>pc4 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">4</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC5</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>pc5 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">5</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>pc1 <span class="sc">+</span> pc2 <span class="sc">+</span> pc3 <span class="sc">+</span> pc4 <span class="sc">+</span> pc5 <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Contributions of Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eda_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 'IPEDS EDA'</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> '`r Sys.Date()`'</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> 'Seunghun Lee'</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-caption: true</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Contents</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">    out-width: "100%"</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 6</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fig.align: "default"</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: tango</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clear-environment}</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Clear environment</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>The notebook is to execute exploratory data analysis for IPEDS data.</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>Data source: <span class="co">[</span><span class="ot">IPEDS</span><span class="co">](https://nces.ed.gov/ipeds/use-the-data)</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>R code: <span class="co">[</span><span class="ot">Github</span><span class="co">](https://github.com/slee0719/ipeds/tree/gh-pages)</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preparations </span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>Loading necessary libraries for data wrangling and visualization.</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries}</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>libs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'openxlsx'</span>, <span class="st">"stringr"</span>,                        <span class="co"># read/write data</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>          <span class="st">'skimr'</span>, <span class="st">"PerformanceAnalytics"</span>, <span class="st">"corrplot"</span>,  <span class="co"># exploring data</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>          <span class="st">"dplyr"</span>, <span class="st">"stringr"</span>, <span class="st">"glue"</span>,                   <span class="co"># data manipulation</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>          <span class="st">'gt'</span>, <span class="st">'ggplot2'</span>, <span class="st">"patchwork"</span>, <span class="st">"psych"</span>,        <span class="co"># data visualization</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>          <span class="st">"naniar"</span>, <span class="st">"mice"</span>,                             <span class="co"># missing data analysis</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>          <span class="st">"stats"</span>, <span class="st">"paran"</span>, <span class="st">"factoextra"</span>,               <span class="co"># feature selection</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>          <span class="st">"rsample"</span>, <span class="st">"glmnet"</span>)                          <span class="co"># predictive analysis</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(libs, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Helper Functions</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>Create helper functions to facilitate an analysis</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-functions}</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="co"># negation of %in%</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="st">'%!in%'</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y)<span class="sc">!</span>(<span class="st">'%in%'</span>(x,y)) </span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a><span class="co"># prevent clashes with other packages</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select </span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity check custom function</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>sanity_check <span class="ot">&lt;-</span> <span class="cf">function</span>(data, type, vars) {</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>  enquo_cols <span class="ot">&lt;-</span> <span class="fu">enquos</span>(vars)</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">"missing"</span>){</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check missing values</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    n_missing <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>({{vars}})))</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The number of missing value in"</span>, <span class="st">" "</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(vars)), <span class="st">" "</span>, <span class="st">"is"</span>, <span class="st">" "</span>, <span class="fu">toString</span>(n_missing)))</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>({{vars}})) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(type <span class="sc">==</span> <span class="st">"duplication"</span>){</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check duplicated values</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>    n_dup <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by_at</span>(enquo_cols) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>({{vars}}) <span class="sc">%&gt;%</span> <span class="fu">with</span>(<span class="fu">nrow</span>(.))</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The unique number of duplicated value"</span>, <span class="st">" is "</span>, <span class="fu">toString</span>(n_dup)))</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>    dup_list <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by_at</span>(enquo_cols) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>({{vars}})</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(dup_list, <span class="at">by =</span> <span class="fu">names</span>(<span class="fu">select</span>(., {{vars}}))) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"skim"</span>) {</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skim data</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>    skimr<span class="sc">::</span><span class="fu">skim</span>(data) <span class="sc">%&gt;%</span> <span class="fu">return</span>()</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import data</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>Importing data for our analysis.</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>ipeds <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"../data/IPEDS_data.xlsx"</span>) </span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview: Structure and Data Content</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>The first thing I want to do is to look at the actual data in its raw form. It will show the types of features I am dealing with (numeric, categorical, string, etc.), as well as will reveal some characteristics of the dataset. This includes the process of missing data analysis.</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Skimming data</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>I start by examining the data through the <span class="in">`skimr`</span> tool. It allows us to see the data types involved and the shape of the data.</span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r skim-data}</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: 'markup'</span></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(ipeds) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>I find:</span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The dataset contains 145 columns and 1534 rows, which is relatively small in terms of sample size. The number of variables is considerably large considering the sample size.</span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is <span class="in">`ID.number`</span> column with appears to be an unique identifier.</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are 27 string columns in the dataset. Those consist of basic information of the institution and the features (e.g. degree offered, religious affiliation).</span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are 118 numeric columns in the dataset. Some of columns are suppposed to be converted to the categorical variable considering their forms (e.g. <span class="in">`ID.number`</span>)</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Missing values can be observed from the data. This is something I need to keep in mind in future exploratory and modelling steps.</span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Removing redundant variables</span></span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a>Let's select only "useful" information from the data</span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Categorical variables</span></span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>ipeds <span class="sc">%&gt;%</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Religious.affiliation, Level.of.institution, Control.of.institution, Historically.Black.College.or.University, Tribal.college) <span class="sc">%&gt;%</span></span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Categorical Variables"</span> <span class="ot">=</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>Categorical variables selection: </span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Religious.affiliation`</span>: to which religion is the school affiliated (e.g. Churches of Christ)</span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Level.of.institution`</span>: the level of degree being offered (e.g. Four or more years)</span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Copntrol.of.institution`</span>: indicates whether it is private or public school</span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Historically.Black.College.or.University`</span>: indicates whether it is historically black institution</span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Tribal.college`</span>: indicates whether the college is affiliated with a tribe</span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numeric variables</span></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a>ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID.number, Enrolled.total, ACT.Composite<span class="fl">.75</span>th.percentile.score, <span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>), <span class="st">`</span><span class="at">Number.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>, <span class="st">`</span><span class="at">Graduation.rate.-.Bachelor.degree.within.4.years,.total</span><span class="st">`</span>, Percent.of.freshmen.receiving.Pell.grants) <span class="sc">%&gt;%</span></span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Numeric Variables"</span> <span class="ot">=</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a>Numeric variables selection:</span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ID.number`</span>: the school unique identifier</span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Enrolled.total`</span>: the number of student who were actually enrolled </span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ACT.Composite.75th.percentile.score`</span>: 75th percentile composite ACT score</span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Percent.of.undergraduate.enrollment.that.are`</span>: variables indicate the percentage of ethnicity of undergraduate who enrolled </span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Number.of.first-time.undergraduates.-.in-state`</span>: indicates the number of in-state undergraduates who are included in the group of "first-time college entrants"</span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Graduation.rate.-.Bachelor.degree.within.4.years,.total`</span>: the percentage of undergraduates graduating within 4 years</span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Percent.of.freshmen.receiving.Pell.grants`</span>: the percentage of freshmen who received the <span class="co">[</span><span class="ot">Federal Pell Grant</span><span class="co">](https://studentaid.gov/understand-aid/types/grants/pell)</span></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a><span class="do">## Change the nambes of variables </span></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a>ipeds_sub <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id =</span> ID.number,</span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">bach =</span> <span class="st">`</span><span class="at">Offers.Bachelor's.degree</span><span class="st">`</span>,</span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrolled_total =</span> Enrolled.total, </span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>         <span class="at">act_75th_percentile =</span> ACT.Composite<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a>         <span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>), </span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">ftic_perc =</span> <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>,</span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">bachelor_within_4years =</span> <span class="st">`</span><span class="at">Graduation.rate.-.Bachelor.degree.within.4.years,.total</span><span class="st">`</span>, </span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>         <span class="at">pell_grant_perc =</span> Percent.of.freshmen.receiving.Pell.grants, </span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>         <span class="at">religion =</span> Religious.affiliation, </span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">edu_level =</span> Level.of.institution, </span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">sch_type =</span> Control.of.institution, </span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">black_inst =</span> Historically.Black.College.or.University, </span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">tribal_inst =</span> Tribal.college) <span class="sc">%&gt;%</span></span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"perc_ai_an"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.American.Indian.or.Alaska.Native,</span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_as"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Asian,</span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_bl"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Black.or.African.American,</span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_hi"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Hispanic/Latino</span><span class="st">`</span>,</span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_nh_pi"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Native.Hawaiian.or.Other.Pacific.Islander,</span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_wh"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.White,</span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_mix"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.two.or.more.races,</span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_un"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Race/ethnicity.unknown</span><span class="st">`</span>,</span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_in"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Nonresident.Alien,</span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a>         <span class="st">"perc_f"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.women</span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sch_type =</span> <span class="fu">ifelse</span>(sch_type <span class="sc">==</span> <span class="st">"Public"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Asian/Native.Hawaiian/Pacific.Islander</span><span class="st">`</span>) </span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a><span class="do">## Feature transformation</span></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a>ipeds_sub <span class="ot">&lt;-</span> ipeds_sub <span class="sc">%&gt;%</span> </span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(is.character, as.factor)) </span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a><span class="fu"># Missing Data Analysis</span></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a>Let's have a closer look at those missing values. How many are there in total in the dataset?</span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(ipeds_sub <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(enrolled_total), enrolled_total <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(bach <span class="sc">==</span> <span class="st">"Yes"</span>)) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a>There are various missing values in most of the columns. In this case, it is good to categorize them into the <span class="co">[</span><span class="ot">types of missing data</span><span class="co">](https://en.wikipedia.org/wiki/Missing_data)</span>.</span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a>I find:</span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pell_grant_perc`</span>: MCAR, hard to figure out the rationale of the missing data due to its small number (3 NAs) -- will be removed from the dataset</span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bachelor_within_4years`</span>: MCAR, as other related columns (<span class="in">`Bachelor_within_5years`</span> and <span class="in">`Bachelor_within_6years`</span>) are also empty, it appears that these entries were not reported -- will be removed from the dataset</span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`act_75th_percentile`</span>: MAR, some applicants chose to take either the SAT or ACT for their college admission requirements. Assuming that the SAT score is positively correlated with the ACT score, multiple imputation will be conducted to fill in the blank.</span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ftic_perc`</span>: the <span class="in">`ftic_perc`</span> column contains a significant number of missing values, accounting for 37.6% of the data. To address this issue, we should investigate potential methods for imputing these missing values. While we currently lack information regarding any potential issues during the data collection process, it might be beneficial to explore insights from the dataset, such as information available in other columns, in order to assist with imputation. Following columns are potential variables which might be related to the <span class="in">`ftic_perc`</span> - **any ethnic properties**, **school type**, **pell_grant_perc**</span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Enrolled.total)) <span class="sc">%&gt;%</span></span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Offers.Bachelor's.degree</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percent.of.freshmen.receiving.Pell.grants)) <span class="sc">%&gt;%</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"Percent.of.undergraduate.enrollment.that.are."</span>),</span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a>         Control.of.institution,</span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a>         Historically.Black.College.or.University,</span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a>         Tribal.college,</span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>         Percent.of.freshmen.receiving.Pell.grants,</span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Control.of.institution =</span> <span class="fu">ifelse</span>(Control.of.institution <span class="sc">==</span> <span class="st">"Public"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a>         <span class="at">Historically.Black.College.or.University =</span> <span class="fu">ifelse</span>(Historically.Black.College.or.University <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a>         <span class="at">Tribal.college =</span> <span class="fu">ifelse</span>(Tribal.college <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"perc_ai_an"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.American.Indian.or.Alaska.Native,</span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_as"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Asian,</span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_bl"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Black.or.African.American,</span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_hi"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Hispanic/Latino</span><span class="st">`</span>,</span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_nh_pi"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Native.Hawaiian.or.Other.Pacific.Islander,</span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_wh"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.White,</span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_mix"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.two.or.more.races,</span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_un"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Race/ethnicity.unknown</span><span class="st">`</span>,</span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_in"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.Nonresident.Alien,</span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a>       <span class="st">"perc_f"</span> <span class="ot">=</span> Percent.of.undergraduate.enrollment.that.are.women,</span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a>       <span class="st">"bl_colllege"</span> <span class="ot">=</span> Historically.Black.College.or.University,</span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a>       <span class="st">"tribal_college"</span> <span class="ot">=</span> Tribal.college,</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a>       <span class="st">"sch_type"</span> <span class="ot">=</span> Control.of.institution,</span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a>       <span class="st">"pell"</span> <span class="ot">=</span> Percent.of.freshmen.receiving.Pell.grants,</span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a>       <span class="st">"ftic"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent.of.first-time.undergraduates.-.in-state</span><span class="st">`</span></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Percent.of.undergraduate.enrollment.that.are.Asian/Native.Hawaiian/Pacific.Islander</span><span class="st">`</span>) </span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(foo, <span class="at">histogram=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a>As indicated in the correlation chart above, the top three variables associated with <span class="in">`ftic`</span> are <span class="in">`school_type`</span> (public or private), <span class="in">`pell_grant_perc`</span>, and <span class="in">`perc_in`</span> (non-resident alien). This findings align with my expectation for several reasons. First, non-resident aliens, who are international students, typically attend college in their home countries before attending college in the US. Second, students who can afford the tuition at multiple colleges are generally ineligible for the Pell Grant.</span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a>foo <span class="sc">%&gt;%</span></span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sch_type) <span class="sc">%&gt;%</span></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(ftic),</span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a>            <span class="fu">median</span>(ftic)) <span class="sc">%&gt;%</span></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a>The most interesting variables is 'school_type.' In this analysis, I have defined "1" as public and "0" as private school. Notably, the proportion of ftic students is significantly higher in public schools. Here, we may hypothesize that students who already possess a bachelor's degree tend to opt for private colleges, which are perceived to offer higher educational quality. **Please note that this assumption is for the purpose of explaining the result and may be open to debate**.</span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a>Based on the finding and the assumption, I define the missing values in ftic column as MAR and will conduct the multiple imputation using <span class="in">`school_type`</span>, <span class="in">`pell_grant_perc`</span>, and <span class="in">`perc_in`</span>.</span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Listwise deletion</span></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a>Simply remove the cases with NAs in such columns - <span class="in">`pell_grant_pec`</span>, <span class="in">`bachelor_within_4years`</span></span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld <span class="ot">&lt;-</span> ipeds_sub <span class="sc">%&gt;%</span> </span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(enrolled_total <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(enrolled_total)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bach <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pell_grant_perc)) <span class="sc">%&gt;%</span> <span class="co"># remove NA cases from pell_grant_perc</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bachelor_within_4years)) <span class="co"># remove NA cases from bachelor_within_4years</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld <span class="sc">%&gt;%</span> <span class="fu">select</span>(pell_grant_perc, bachelor_within_4years) <span class="sc">%&gt;%</span> <span class="fu">miss_var_summary</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Imputation</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a><span class="fu"># ACT</span></span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a>Let's create <span class="in">`sat_comp`</span> variable to combine all the SAT scores and conduct an univariate imputation with the combined sat score.</span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a>Imputation information is below:</span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a>ipeds_sat <span class="ot">&lt;-</span> ipeds <span class="sc">%&gt;%</span> </span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID.number, </span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a>                 SAT.Critical.Reading<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a>                 SAT.Math<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>                 SAT.Writing<span class="fl">.75</span>th.percentile.score) <span class="sc">%&gt;%</span> </span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> ID.number, </span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_read =</span> SAT.Critical.Reading<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_math =</span> SAT.Math<span class="fl">.75</span>th.percentile.score, </span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a>         <span class="at">sat_writing =</span> SAT.Writing<span class="fl">.75</span>th.percentile.score) <span class="sc">%&gt;%</span></span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sat_comp =</span> <span class="fu">rowMeans</span>(<span class="fu">subset</span>(., <span class="at">select =</span> <span class="fu">c</span>(sat_read, sat_math, sat_writing)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat <span class="ot">&lt;-</span> ipeds_sub_ld <span class="sc">%&gt;%</span></span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ipeds_sat, <span class="at">by =</span> <span class="st">"id"</span>) </span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned <span class="ot">&lt;-</span> ipeds_sub_ld_sat <span class="sc">%&gt;%</span> </span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">drop =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(sat_comp), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(drop <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(ipeds_sub_ld_sat_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(act_75th_percentile, sat_comp), </span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>            <span class="at">m =</span> <span class="dv">10</span>,</span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a>            <span class="at">defaultMethod =</span> <span class="st">"pmm"</span>,</span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>            <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(imp)</span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(act_75th_percentile, sat_comp)) <span class="sc">%&gt;%</span></span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">complete</span>(imp))</span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a><span class="fu"># FTIC</span></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>Conduct multiple imputation with <span class="in">`pecc_in`</span>, <span class="in">`pell_grant_perc`</span>, and <span class="in">`sch_type`</span>.</span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>Imputation information is below:</span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act <span class="sc">%&gt;%</span> <span class="fu">select</span>(perc_in, pell_grant_perc, sch_type, ftic_perc)</span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(foo, </span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a>     <span class="at">m =</span> <span class="dv">10</span>,</span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a>     <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>     <span class="at">defaultMethod =</span> <span class="st">"pmm"</span>,</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a>     <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(imp)</span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act_ftic <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act <span class="sc">%&gt;%</span></span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ftic_perc)) <span class="sc">%&gt;%</span></span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">complete</span>(imp) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ftic_perc)) </span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check</span></span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>Let's clean the data and check the missing values again.</span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>ipeds_sub_ld_sat_cleaned_act_ftic2 <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act_ftic <span class="sc">%&gt;%</span> </span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(bach, drop, religion, edu_level, tribal_inst,sat_read, sat_math, sat_writing)) <span class="sc">%&gt;%</span></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sch_type_desc =</span> <span class="fu">ifelse</span>(sch_type <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"public"</span>, <span class="st">"private"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">black_inst_d =</span> <span class="fu">ifelse</span>(black_inst <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(ipeds_sub_ld_sat_cleaned_act_ftic2) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="ot">&lt;-</span> ipeds_sub_ld_sat_cleaned_act_ftic2 </span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>No more missing value. Good!</span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualization </span></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a>Let's take a look at the distribution of variables</span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Predictor Features</span></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a>To assemble the plots in the comprehensive, dashboard-like overview we are using the <span class="co">[</span><span class="ot">patchwork package</span><span class="co">](https://patchwork.data-imaginist.com/index.html)</span>. </span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 12</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 13</span></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pell_grant_perc)) <span class="sc">+</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Pell Grant Percentage"</span>)</span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sch_type_desc) <span class="sc">%&gt;%</span></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sch_type_desc, n, <span class="at">fill =</span> sch_type_desc)) <span class="sc">+</span></span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"School Type"</span>)</span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(black_inst, n, <span class="at">fill =</span> black_inst)) <span class="sc">+</span></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Black Institution"</span>) </span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(act_75th_percentile)) <span class="sc">+</span></span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"ACT 75th Percentile"</span>)</span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ftic_perc)) <span class="sc">+</span></span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"violet"</span>) <span class="sc">+</span></span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"FTIC Percentage"</span>)</span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a><span class="st">ABC</span></span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a><span class="st">DEE</span></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span></span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> design) <span class="sc">+</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Variable Distributions"</span>)</span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>I find:</span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The distribution of <span class="in">`pell_grant_percentage`</span> and <span class="in">`act_7hth`</span> are nearly normally distributed (slightly right skewed).</span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`school_type`</span> and <span class="in">`black_institution`</span> are boolean features. </span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ftic_perc`</span> is severely left skewed. May need a transformation if we want to add it in our model.</span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Target: `bachelor_within_4years`</span></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 3</span></span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years)) <span class="sc">+</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Target: Bachelor within 4 Years"</span>)</span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>We find:</span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is a slight imbalance in the target distribution. Slightly right skewed.</span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a><span class="fu">## Predictor Feature Interactions</span></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a>How do the predictor features interact with each other?</span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlations</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>When plotting a correlation matrix, we need to make sure that what we're feeding in doesn't include any missing values. We can specify this via the parameter <span class="in">`use = "complete.obs"`</span>:</span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span> </span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, enrolled_total, sat_comp, sch_type_desc)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">black_inst_d =</span> <span class="fu">ifelse</span>(black_inst <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(bachelor_within_4years, <span class="at">.after =</span> ftic_perc) <span class="sc">%&gt;%</span> </span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chart.Correlation</span>(<span class="at">histogram=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a>We find:</span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multicollinearity is detected among several variables. Feature reduction process is necessary. </span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a><span class="fu">### Categorical feature interactions</span></span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span></span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bachelor_within_4years, sch_type_desc) <span class="sc">%&gt;%</span></span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years, <span class="at">group =</span> sch_type_desc, <span class="at">fill =</span> sch_type_desc)) <span class="sc">+</span></span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>We find:</span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The number of students who got their bachelor in 4 years are larger in private schools than in public school</span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a>ipeds_imp <span class="sc">%&gt;%</span></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bachelor_within_4years, black_inst) <span class="sc">%&gt;%</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bachelor_within_4years, <span class="at">group =</span> black_inst, <span class="at">fill =</span> black_inst)) <span class="sc">+</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>We find:</span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The number of students who got their bachelor in 4 years are larger in non-black institution than in black institution</span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a><span class="fu"># Feature Selection</span></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>Conducting Principal Component Analysis using the Horn's Parallel Analysis.</span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a><span class="fu">## Principal Component Analysis</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a>ipeds_imp_sub <span class="ot">&lt;-</span> ipeds_imp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, enrolled_total, black_inst, sat_comp, sch_type_desc))</span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a>pca_model <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(ipeds_imp_sub, <span class="at">scale=</span><span class="cn">TRUE</span>)  </span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a><span class="fu"># Explained Variances</span></span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_model)</span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploring Eigenvalues</span></span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a><span class="fu">get_eigenvalue</span>(pca_model)</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualization</span></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_model, </span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a>         <span class="at">choice =</span> <span class="fu">c</span>(<span class="st">"eigenvalue"</span>),</span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.var=</span><span class="st">"blue"</span>)</span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>Based on the proportion of explained variance and the scree plot using eigenvalue, 4 components seem appropriate. However, recognizing the interpretation is subjective, an additional analysis is necessary to validate its plausibility.</span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parallel Analysis</span></span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a><span class="fu">paran</span>(ipeds_imp_sub, <span class="at">graph =</span> <span class="cn">TRUE</span>, <span class="at">cfa =</span> <span class="cn">FALSE</span>, <span class="at">centile =</span> <span class="dv">95</span>)</span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a>According to Horn's Parallel Analysis, 5 components can be selected.</span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a><span class="fu">## Contributions of variables to each PCs</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC1</span></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>pc1 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span>)</span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC2</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a>pc2 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">2</span>)</span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC3</span></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a>pc3 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">3</span>)</span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC4</span></span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a>pc4 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">4</span>)</span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC5</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a>pc5 <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(pca_model, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">5</span>)</span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a>pc1 <span class="sc">+</span> pc2 <span class="sc">+</span> pc3 <span class="sc">+</span> pc4 <span class="sc">+</span> pc5 <span class="sc">+</span></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Contributions of Variables"</span>)</span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>